var requestToAPI,konSchoolAPI="api",mfDoughnutChart=null,maleFemaleRatio={maleOnly:0,femaleOnly:0,combined:0,typeBoysHasGirls:0,typeGirlsHasBoys:0},schoolLevelRatio={higher:0,juniorSecondary:0,secondary:0},areaStatusCode={.1:1,.2:2,.4:3,.5:4,.7:5,.9:6,1:7},areaDataSet=[],areaRegressionIndependentData=[],areaRegressionDependentData=[],areaRegressionIndependentDataSquare=[],areaRegressionDependentDataSquare=[],areaRegressionMultiplication=[],summationOfY=0,summationOfX=0,summationOfYSquare=0,summationOfXSquare=0,summationOfXY=0,averageOfY=0,dataTableDependencies=[],sizeOfDataSet=0,yBar=0,xBar=0,schoolNameTSR=[],schoolMin5TSR=[["School Name","Student","Teacher"]],colorScheme01=["#35326B","#553E8A","#7A4B94","#B66673","#C38980"],colorScheme02=["#2A639B","#75CFB4","#ADE2D2","#A9859E","#7F5080","#702474"],colorScheme03=["#476088","#FFC562","#FF6D74","#A9859E","#4FDDC3","#61A8E8"],colorScheme04=["#FE7914","#FFDD55","#DFF1B8","#66C068","#299259"];function scrollToAnalyticalResultDivision(){$("html, body").animate({scrollTop:$("#analyticalResults").offset().top},1300)}function clearOnRecurrentRequests(){maleFemaleRatio={maleOnly:0,femaleOnly:0,combined:0,typeBoysHasGirls:0,typeGirlsHasBoys:0},schoolLevelRatio={higher:0,juniorSecondary:0,secondary:0},null!=mfDoughnutChart&&mfDoughnutChart.destroy(),areaDataSet=[],areaRegressionIndependentData=[],areaRegressionDependentData=[],areaRegressionIndependentDataSquare=[],areaRegressionDependentDataSquare=[],areaRegressionMultiplication=[],summationOfY=0,summationOfX=0,summationOfYSquare=0,summationOfXSquare=0,dataTableDependencies=[],summationOfXY=0,averageOfY=0,sizeOfDataSet=0,yBar=0,xBar=0,schoolNameTSR=[],schoolMin5TSR=[["School Name","Student","Teacher"]]}function toTitleCase(e){return e.replace(/\w\S*/g,function(e){return e.charAt(0).toUpperCase()+e.substr(1).toLowerCase()})}function filterAPIData(e){for(var a=e.length-1;a>=0;a--)filterMaleFemaleRatio(e[a].MFRatio,e[a].type),filterSchoolLevel(e[a].level),prepareLinearRegressionDataSet(e[a].Area),formSchoolWithTSR(e[a].Name,e[a].TSRatio);var t=$.map(maleFemaleRatio,function(e){return e});createDoughnutBasedOnMFRatio(Object.keys(maleFemaleRatio),t,"doughnut",$("#_maleFemaleCombinedDoughnut"),""),summarizeMFinTable(e.length),summarizeSchoolLevelInCards(),wordCounterAnimation(),formRegressionDependency(),performSquareOnDependency(),performMultiplicationBetweenDependencies(),performSummationOnDependency(),mergeDependenciesForDataTable(),visualizeRegressionData();showSchoolsWithLessTeacher(schoolNameTSR.sort(function(e,a){return e.numberOfTeachers-a.numberOfTeachers}),5)}function filterMaleFemaleRatio(e,a){0===e&&"BOYS"===a?maleFemaleRatio.maleOnly++:1===e&&"GIRLS"===a?maleFemaleRatio.femaleOnly++:0!==e&&"BOYS"===a?maleFemaleRatio.typeBoysHasGirls++:1!==e&&"GIRLS"===a?maleFemaleRatio.typeGirlsHasBoys++:maleFemaleRatio.combined++}function createDoughnutBasedOnMFRatio(e,a,t,n,o){mfDoughnutChart=new Chart(n,{type:t,data:{labels:e,datasets:[{label:"Value",data:a,backgroundColor:colorScheme01,borderColor:colorScheme01,borderWidth:1}]},options:{title:{display:!1,text:o,fontSize:25},responsive:!0,responsiveAnimationDuration:1300,mainAspectRatio:!1}})}function summarizeMFinTable(e){$("#_td1").text(maleFemaleRatio.maleOnly),$("#_td2").text(maleFemaleRatio.femaleOnly),$("#_td3").text(maleFemaleRatio.combined),$("#_td4").text(maleFemaleRatio.typeBoysHasGirls),$("#_td5").text(maleFemaleRatio.typeGirlsHasBoys),$("#_td6").text(e)}function filterSchoolLevel(e){"Higher Secondary"===e?schoolLevelRatio.higher++:"Junior Secondary"===e?schoolLevelRatio.juniorSecondary++:schoolLevelRatio.secondary++}function summarizeSchoolLevelInCards(){$("#_analyticalResultCard01").text(schoolLevelRatio.higher),$("#_analyticalResultCard02").text(schoolLevelRatio.juniorSecondary),$("#_analyticalResultCard03").text(schoolLevelRatio.secondary)}function wordCounterAnimation(){$(".count").each(function(){$(this).prop("Counter",0).animate({Counter:$(this).text()},{duration:3e3,easing:"swing",step:function(e){$(this).text(Math.ceil(e))}})})}function prepareLinearRegressionDataSet(e){var a={};a[e]=areaStatusCode[e],areaDataSet.push(a)}function formRegressionDependency(){for(var e={},a=0;a<areaDataSet.length;a++)e=areaDataSet[a],pushRegressionDependency(parseFloat(Object.keys(e)[0]),parseFloat(e[Object.keys(e)[0]]))}function pushRegressionDependency(e,a){areaRegressionIndependentData.push(e),areaRegressionDependentData.push(a)}function performSquareOnDependency(){areaRegressionIndependentDataSquare=areaRegressionIndependentData.map(function(e){return e*e}),areaRegressionDependentDataSquare=areaRegressionDependentData.map(function(e){return e*e})}function performSummationOnDependency(){summationOfY=areaRegressionDependentData.reduce(function(e,a){return e+a},0),summationOfX=areaRegressionIndependentData.reduce(function(e,a){return e+a},0),summationOfYSquare=areaRegressionDependentDataSquare.reduce(function(e,a){return e+a},0),summationOfXSquare=areaRegressionIndependentDataSquare.reduce(function(e,a){return e+a},0),summationOfXY=areaRegressionMultiplication.reduce(function(e,a){return e+a},0),averageOfY=summationOfY/areaRegressionDependentData.length,sizeOfDataSet=areaRegressionIndependentData.length,yBar=summationOfY/sizeOfDataSet,xBar=summationOfX/sizeOfDataSet}function performMultiplicationBetweenDependencies(){areaRegressionMultiplication=areaRegressionIndependentData.map(function(e,a){return e*areaRegressionDependentData[a]})}function mergeDependenciesForDataTable(){for(var e=0;e<areaRegressionDependentData.length;e++)dataTableDependencies.push({AreaEvaluationY:areaRegressionDependentData[e],AreaStatusX:areaRegressionIndependentData[e],X_Multiply_Y:areaRegressionMultiplication[e],AreaEvaluationYSquare:areaRegressionDependentDataSquare[e],AreaStatusXSquare:areaRegressionIndependentDataSquare[e]})}function visualizeRegressionData(){$("#demoRegressionAPI").text(JSON.stringify(dataTableDependencies[0],function(e,a){return a.toFixed?Number(a.toFixed(3)):a},2)),$("#_fullRegressionAPI").text(JSON.stringify(dataTableDependencies,function(e,a){return a.toFixed?Number(a.toFixed(3)):a},2)),$("#_summationOfX").text("Σ(X) = "+summationOfX),$("#_summationOfY").text("Σ(Y) = "+summationOfY),$("#_summationOfXY").text("Σ(X*Y) = "+summationOfXY),$("#_summationOfXsq").text("Σ(X²) = "+summationOfXSquare),$("#_intercept").text("β₁ = (Σ(X*Y)-((Σ(X) * Σ(Y))/n)) / Σ(X²) - ((Σ(X))²/n) = "+calculateLinearIntercept());var e=$("#_slope").text("β₀ = y̅ - β₁*x̅ \n => β₀ = "+calculateLinearSlope());e.html(e.html().replace(/\n/g,"<br/>"));var a=$("#_areaRegressionModel").text("Y = β₀ + β₁X \n => Y = "+calculateLinearSlope().toPrecision(3)+" + "+calculateLinearIntercept().toPrecision(3)+"X");a.html(a.html().replace(/\n/g,"<br/>"))}function calculateLinearIntercept(){return(summationOfXY-summationOfX*summationOfY/sizeOfDataSet)/(summationOfXSquare-Math.pow(summationOfX,2)/sizeOfDataSet)}function calculateLinearSlope(){return yBar-calculateLinearIntercept()*xBar}function formSchoolWithTSR(e,a){schoolNameTSR.push({schoolName:toTitleCase(e),numberOfStudents:100,numberOfTeachers:100*a})}function showSchoolsWithLessTeacher(e,a){for(var t=0;t<a;t++)$("#_tsr-school0"+(t+1)).text(e[t].schoolName),$("#_tsr-Teacher"+(t+1)).text(e[t].numberOfTeachers),$("#_tsr-Student"+(t+1)).text(e[t].numberOfStudents)}$(document).ready(function(){Chart.defaults.global.defaultFontColor="#fff",Chart.defaults.global.defaultFontFamily="'Manjari'",Chart.defaults.global.defaultFontSize=15,Chart.defaults.global.animation.duration=1500,$("#analyticalResults").hide(),$("#_analyticalResultPreloader").hide(),$("#_analyticalResultContent").hide(),$("#_analyticalResultHeading").hide(),$("#mapCol a").click(function(){clearOnRecurrentRequests();var e=$(this).data("value");$("#analyticalResults").slideDown(),$("#_analyticalResultPreloader").fadeIn(),scrollToAnalyticalResultDivision(),requestToAPI=$.get(konSchoolAPI+"/schools/dis/"+e.toUpperCase(),function(a,t){$("#_analyticalResultHeading").fadeOut(1500,function(){$(this).text("Schools of "+toTitleCase(e)).fadeIn(500)}),filterAPIData(a),$("#_analyticalResultPreloader").hide(),$("#_analyticalResultContent").fadeIn()})})});